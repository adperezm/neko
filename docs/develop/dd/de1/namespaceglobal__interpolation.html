<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Neko: global_interpolation Module Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Neko
   &#160;<span id="projectnumber">0.7.99</span>
   </div>
   <div id="projectbrief">A portable framework for high-order spectral element flow simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/de1/namespaceglobal__interpolation.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">global_interpolation Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements <a class="el" href="../../dd/de1/namespaceglobal__interpolation.html" title="Implements global_interpolation given a dofmap.">global_interpolation</a> given a dofmap.  
<a href="../../dd/de1/namespaceglobal__interpolation.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements global interpolation for arbitrary points in the domain.  <a href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aed5605e24dd0355f7b4f4c4a1b1b6e6b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#aed5605e24dd0355f7b4f4c4a1b1b6e6b">global_interpolation_init</a> (this, dof, tol)</td></tr>
<tr class="memdesc:aed5605e24dd0355f7b4f4c4a1b1b6e6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate only local points.  <a href="../../dd/de1/namespaceglobal__interpolation.html#aed5605e24dd0355f7b4f4c4a1b1b6e6b">More...</a><br /></td></tr>
<tr class="separator:aed5605e24dd0355f7b4f4c4a1b1b6e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da3dca9e49ce1adae0a90ab85e9deef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#a1da3dca9e49ce1adae0a90ab85e9deef">global_interpolation_free</a> (this)</td></tr>
<tr class="memdesc:a1da3dca9e49ce1adae0a90ab85e9deef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../dd/de1/namespaceglobal__interpolation.html#a1da3dca9e49ce1adae0a90ab85e9deef">More...</a><br /></td></tr>
<tr class="separator:a1da3dca9e49ce1adae0a90ab85e9deef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e3a81dcd84a313a772376f36e9c42e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#a39e3a81dcd84a313a772376f36e9c42e">global_interpolation_free_points</a> (this)</td></tr>
<tr class="memdesc:a39e3a81dcd84a313a772376f36e9c42e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for point arrays.  <a href="../../dd/de1/namespaceglobal__interpolation.html#a39e3a81dcd84a313a772376f36e9c42e">More...</a><br /></td></tr>
<tr class="separator:a39e3a81dcd84a313a772376f36e9c42e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac86ce66619281a9b322688bf9d527c28"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#ac86ce66619281a9b322688bf9d527c28">global_interpolation_find_common</a> (this)</td></tr>
<tr class="memdesc:ac86ce66619281a9b322688bf9d527c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common routine for finding the points.  <a href="../../dd/de1/namespaceglobal__interpolation.html#ac86ce66619281a9b322688bf9d527c28">More...</a><br /></td></tr>
<tr class="separator:ac86ce66619281a9b322688bf9d527c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dfe3afc61fac845acfadaef21e3465c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#a5dfe3afc61fac845acfadaef21e3465c">global_interpolation_find_coords</a> (this, x, y, z, n_points)</td></tr>
<tr class="memdesc:a5dfe3afc61fac845acfadaef21e3465c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the corresponding r,s,t coordinates in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again.  <a href="../../dd/de1/namespaceglobal__interpolation.html#a5dfe3afc61fac845acfadaef21e3465c">More...</a><br /></td></tr>
<tr class="separator:a5dfe3afc61fac845acfadaef21e3465c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419e4bc704c8fcd7549a4de09f5dfbb3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#a419e4bc704c8fcd7549a4de09f5dfbb3">global_interpolation_init_point_arrays</a> (this)</td></tr>
<tr class="separator:a419e4bc704c8fcd7549a4de09f5dfbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8a5b77756f4c2b1b6efb26f7b0163a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#aad8a5b77756f4c2b1b6efb26f7b0163a">global_interpolation_find_xyz</a> (this, xyz, n_points)</td></tr>
<tr class="memdesc:aad8a5b77756f4c2b1b6efb26f7b0163a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the corresponding r,s,t coordinates in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again.  <a href="../../dd/de1/namespaceglobal__interpolation.html#aad8a5b77756f4c2b1b6efb26f7b0163a">More...</a><br /></td></tr>
<tr class="separator:aad8a5b77756f4c2b1b6efb26f7b0163a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d7dd757c992a82f1a201d671ce637d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#ac1d7dd757c992a82f1a201d671ce637d">global_interpolation_find_and_redist</a> (this, xyz, n_points)</td></tr>
<tr class="memdesc:ac1d7dd757c992a82f1a201d671ce637d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again.  <a href="../../dd/de1/namespaceglobal__interpolation.html#ac1d7dd757c992a82f1a201d671ce637d">More...</a><br /></td></tr>
<tr class="separator:ac1d7dd757c992a82f1a201d671ce637d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67a17085d264b5f5d490d1047042ee2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#ae67a17085d264b5f5d490d1047042ee2">global_interpolation_redist</a> (this)</td></tr>
<tr class="separator:ae67a17085d264b5f5d490d1047042ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73584112440598ad7dbbed3cfa9ee2d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html#a73584112440598ad7dbbed3cfa9ee2d9">global_interpolation_evaluate</a> (this, interp_values, field)</td></tr>
<tr class="memdesc:a73584112440598ad7dbbed3cfa9ee2d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evalute the interpolated value in the points given a field on the dofmap.  <a href="../../dd/de1/namespaceglobal__interpolation.html#a73584112440598ad7dbbed3cfa9ee2d9">More...</a><br /></td></tr>
<tr class="separator:a73584112440598ad7dbbed3cfa9ee2d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements <a class="el" href="../../dd/de1/namespaceglobal__interpolation.html" title="Implements global_interpolation given a dofmap.">global_interpolation</a> given a dofmap. </p>
<dl class="section note"><dt>Note</dt><dd>This modules uses functions from <code>gslib</code>, namely <code>findpts_setup</code>, <code>findpts</code>, and <code>findpts_eval</code>. A full description of these subroutines can be found at <a href="https://github.com/Nek5000/gslib/blob/master/src/findpts.c">https://github.com/Nek5000/gslib/blob/master/src/findpts.c</a> </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a73584112440598ad7dbbed3cfa9ee2d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73584112440598ad7dbbed3cfa9ee2d9">&#9670;&nbsp;</a></span>global_interpolation_evaluate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_evaluate </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(this%n_points), intent(inout)&#160;</td>
          <td class="paramname"><em>interp_values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(this%dof%size()), intent(inout)&#160;</td>
          <td class="paramname"><em>field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evalute the interpolated value in the points given a field on the dofmap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">interp_values</td><td>Array of values in the given points. </td></tr>
    <tr><td class="paramname">field</td><td>Array of values used for interpolation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00516">516</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>

</div>
</div>
<a id="ac1d7dd757c992a82f1a201d671ce637d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d7dd757c992a82f1a201d671ce637d">&#9670;&nbsp;</a></span>global_interpolation_find_and_redist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_find_and_redist </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>n_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again. </p>
<ul>
<li><code>error_code</code>: returns <code>0</code> if point found, <code>1</code> if closest point on a border (check dist2), <code>2</code> if not found</li>
<li><code>dist2</code>: distance squared (used to compare the points found by each processor) <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xyz</td><td>The coordinates of the points. </td></tr>
    <tr><td class="paramname">n_points</td><td>The number of points. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>
<p>make deep copy incase xyz goes out of scope or deallocated</p>
<p>Sets new points and redistributes them</p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00397">397</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_ac1d7dd757c992a82f1a201d671ce637d_cgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_ac1d7dd757c992a82f1a201d671ce637d_cgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_ac1d7dd757c992a82f1a201d671ce637d_cgraph" id="add/de1/namespaceglobal__interpolation_ac1d7dd757c992a82f1a201d671ce637d_cgraph">
<area shape="rect" title="Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the corr..." alt="" coords="5,73,165,129"/>
<area shape="rect" href="../../dd/d47/namespacemath.html#aaa9e139d5611c1df894a7e88d240f602" title="Copy a vector ." alt="" coords="454,95,549,122"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac86ce66619281a9b322688bf9d527c28" title="Common routine for finding the points." alt="" coords="213,33,373,89"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a419e4bc704c8fcd7549a4de09f5dfbb3" title=" " alt="" coords="421,162,581,218"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ae67a17085d264b5f5d490d1047042ee2" title=" " alt="" coords="213,113,373,169"/>
</map>
</div>

</div>
</div>
<a id="ac86ce66619281a9b322688bf9d527c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86ce66619281a9b322688bf9d527c28">&#9670;&nbsp;</a></span>global_interpolation_find_common()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_find_common </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Common routine for finding the points. </p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00191">191</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_ac86ce66619281a9b322688bf9d527c28_icgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_ac86ce66619281a9b322688bf9d527c28_icgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_ac86ce66619281a9b322688bf9d527c28_icgraph" id="add/de1/namespaceglobal__interpolation_ac86ce66619281a9b322688bf9d527c28_icgraph">
<area shape="rect" title="Common routine for finding the points." alt="" coords="213,85,373,141"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac1d7dd757c992a82f1a201d671ce637d" title="Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the corr..." alt="" coords="5,5,165,61"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a5dfe3afc61fac845acfadaef21e3465c" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="5,85,165,141"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#aad8a5b77756f4c2b1b6efb26f7b0163a" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="5,165,165,221"/>
</map>
</div>

</div>
</div>
<a id="a5dfe3afc61fac845acfadaef21e3465c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dfe3afc61fac845acfadaef21e3465c">&#9670;&nbsp;</a></span>global_interpolation_find_coords()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_find_coords </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(n_points,1,1,1)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(n_points,1,1,1)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(n_points,1,1,1)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the corresponding r,s,t coordinates in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again. </p>
<ul>
<li><code>error_code</code>: returns <code>0</code> if point found, <code>1</code> if closest point on a border (check dist2), <code>2</code> if not found</li>
<li><code>dist2</code>: distance squared (used to compare the points found by each processor) <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The x-coordinates of the points. </td></tr>
    <tr><td class="paramname">y</td><td>The y-coordinates of the points. </td></tr>
    <tr><td class="paramname">z</td><td>The z-coordinates of the points. </td></tr>
    <tr><td class="paramname">n_points</td><td>The number of points. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00315">315</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_a5dfe3afc61fac845acfadaef21e3465c_cgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_a5dfe3afc61fac845acfadaef21e3465c_cgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_a5dfe3afc61fac845acfadaef21e3465c_cgraph" id="add/de1/namespaceglobal__interpolation_a5dfe3afc61fac845acfadaef21e3465c_cgraph">
<area shape="rect" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="5,45,165,101"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac86ce66619281a9b322688bf9d527c28" title="Common routine for finding the points." alt="" coords="213,5,373,61"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a419e4bc704c8fcd7549a4de09f5dfbb3" title=" " alt="" coords="213,85,373,141"/>
</map>
</div>

</div>
</div>
<a id="aad8a5b77756f4c2b1b6efb26f7b0163a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8a5b77756f4c2b1b6efb26f7b0163a">&#9670;&nbsp;</a></span>global_interpolation_find_xyz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_find_xyz </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), dimension(3,n_points), intent(inout)&#160;</td>
          <td class="paramname"><em>xyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds the corresponding r,s,t coordinates in the correct global element as well as which process that owns the point. After this the values at these points can be evaluated. If the locations of the points change this must be called again. </p>
<ul>
<li><code>error_code</code>: returns <code>0</code> if point found, <code>1</code> if closest point on a border (check dist2), <code>2</code> if not found</li>
<li><code>dist2</code>: distance squared (used to compare the points found by each processor) <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xyz</td><td>The coordinates of the points. </td></tr>
    <tr><td class="paramname">n_points</td><td>The number of points. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>
<p>make deep copy incase xyz goes out of scope or deallocated</p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00367">367</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_aad8a5b77756f4c2b1b6efb26f7b0163a_cgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_aad8a5b77756f4c2b1b6efb26f7b0163a_cgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_aad8a5b77756f4c2b1b6efb26f7b0163a_cgraph" id="add/de1/namespaceglobal__interpolation_aad8a5b77756f4c2b1b6efb26f7b0163a_cgraph">
<area shape="rect" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="5,56,165,112"/>
<area shape="rect" href="../../dd/d47/namespacemath.html#aaa9e139d5611c1df894a7e88d240f602" title="Copy a vector ." alt="" coords="246,5,341,32"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac86ce66619281a9b322688bf9d527c28" title="Common routine for finding the points." alt="" coords="213,56,373,112"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a419e4bc704c8fcd7549a4de09f5dfbb3" title=" " alt="" coords="213,136,373,192"/>
</map>
</div>

</div>
</div>
<a id="a1da3dca9e49ce1adae0a90ab85e9deef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1da3dca9e49ce1adae0a90ab85e9deef">&#9670;&nbsp;</a></span>global_interpolation_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_free </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00152">152</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>

</div>
</div>
<a id="a39e3a81dcd84a313a772376f36e9c42e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39e3a81dcd84a313a772376f36e9c42e">&#9670;&nbsp;</a></span>global_interpolation_free_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_free_points </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for point arrays. </p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00171">171</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>

</div>
</div>
<a id="aed5605e24dd0355f7b4f4c4a1b1b6e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5605e24dd0355f7b4f4c4a1b1b6e6b">&#9670;&nbsp;</a></span>global_interpolation_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_init </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="../../d0/df0/structdofmap_1_1dofmap__t.html">dofmap_t</a>), target&#160;</td>
          <td class="paramname"><em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/dc8/device__config_8h.html#a11d147c64891830c9e79b3315b1b2e21">real</a>(kind=rp), optional&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate only local points. </p>
<p>Initialize user defined variables. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dof</td><td>Dofmap on which the interpolation is to be carried out. </td></tr>
    <tr><td class="paramname">tol</td><td>Tolerance for Newton iterations. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00114">114</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>

</div>
</div>
<a id="a419e4bc704c8fcd7549a4de09f5dfbb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419e4bc704c8fcd7549a4de09f5dfbb3">&#9670;&nbsp;</a></span>global_interpolation_init_point_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_init_point_arrays </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00342">342</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_a419e4bc704c8fcd7549a4de09f5dfbb3_icgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_a419e4bc704c8fcd7549a4de09f5dfbb3_icgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_a419e4bc704c8fcd7549a4de09f5dfbb3_icgraph" id="add/de1/namespaceglobal__interpolation_a419e4bc704c8fcd7549a4de09f5dfbb3_icgraph">
<area shape="rect" title=" " alt="" coords="421,73,581,129"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac1d7dd757c992a82f1a201d671ce637d" title="Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the corr..." alt="" coords="5,81,165,137"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a5dfe3afc61fac845acfadaef21e3465c" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="213,33,373,89"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#aad8a5b77756f4c2b1b6efb26f7b0163a" title="Finds the corresponding r,s,t coordinates in the correct global element as well as which process that..." alt="" coords="213,113,373,169"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ae67a17085d264b5f5d490d1047042ee2" title=" " alt="" coords="213,193,373,249"/>
</map>
</div>

</div>
</div>
<a id="ae67a17085d264b5f5d490d1047042ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae67a17085d264b5f5d490d1047042ee2">&#9670;&nbsp;</a></span>global_interpolation_redist()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine global_interpolation::global_interpolation_redist </td>
          <td>(</td>
          <td class="paramtype">class(<a class="el" href="../../dc/df3/structglobal__interpolation_1_1global__interpolation__t.html">global_interpolation_t</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate which processes this proc has points on</p>
<p>Sum number of points on all pes to compute n_new_points Store how many points to receive from each pe</p>
<p>This could be avoided by adding all indices to a list</p>

<p class="definition">Definition at line <a class="el" href="../../db/d27/global__interpolation_8F90_source.html#l00439">439</a> of file <a class="el" href="../../db/d27/global__interpolation_8F90_source.html">global_interpolation.F90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_cgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_cgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_cgraph" id="add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_cgraph">
<area shape="rect" title=" " alt="" coords="5,24,165,80"/>
<area shape="rect" href="../../dd/d47/namespacemath.html#aaa9e139d5611c1df894a7e88d240f602" title="Copy a vector ." alt="" coords="246,5,341,32"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#a419e4bc704c8fcd7549a4de09f5dfbb3" title=" " alt="" coords="213,56,373,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_icgraph.png" border="0" usemap="#add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_icgraph" alt=""/></div>
<map name="add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_icgraph" id="add/de1/namespaceglobal__interpolation_ae67a17085d264b5f5d490d1047042ee2_icgraph">
<area shape="rect" title=" " alt="" coords="213,5,373,61"/>
<area shape="rect" href="../../dd/de1/namespaceglobal__interpolation.html#ac1d7dd757c992a82f1a201d671ce637d" title="Finds the corresponding r,s,t coordinates and redistributes the points to the owning rank in the corr..." alt="" coords="5,5,165,61"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/de1/namespaceglobal__interpolation.html">global_interpolation</a></li>
    <li class="footer">Generated on Sat Mar 2 2024 03:36:15 for Neko by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
